<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Discrete continuation · OptimalControl.jl</title><meta name="title" content="Discrete continuation · OptimalControl.jl"/><meta property="og:title" content="Discrete continuation · OptimalControl.jl"/><meta property="twitter:title" content="Discrete continuation · OptimalControl.jl"/><meta name="description" content="Documentation for OptimalControl.jl."/><meta property="og:description" content="Documentation for OptimalControl.jl."/><meta property="twitter:description" content="Documentation for OptimalControl.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="https://control-toolbox.org/assets/css/documentation.css" rel="stylesheet" type="text/css"/><script src="https://control-toolbox.org/assets/js/documentation.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">OptimalControl.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Getting Started</a></li><li><span class="tocitem">Basic Examples</span><ul><li><a class="tocitem" href="tutorial-double-integrator-energy.html">Energy minimisation</a></li><li><a class="tocitem" href="tutorial-double-integrator-time.html">Time mininimisation</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="tutorial-abstract.html">Define a problem</a></li><li><a class="tocitem" href="tutorial-initial-guess.html">Set an initial guess</a></li><li><a class="tocitem" href="tutorial-solve.html">Solve a problem</a></li><li><a class="tocitem" href="tutorial-plot.html">Plot a solution</a></li><li><a class="tocitem" href="tutorial-flow.html">Compute flows</a></li></ul></li><li><span class="tocitem">Tutorials and Advanced Features</span><ul><li class="is-active"><a class="tocitem" href="tutorial-continuation.html">Discrete continuation</a><ul class="internal"><li><a class="tocitem" href="#Continuation-on-parametric-OCP"><span>Continuation on parametric OCP</span></a></li><li><a class="tocitem" href="#Continuation-on-global-variable"><span>Continuation on global variable</span></a></li></ul></li><li><a class="tocitem" href="tutorial-discretisation.html">Discretisation methods</a></li><li><a class="tocitem" href="tutorial-nlp.html">NLP manipulations</a></li><li><a class="tocitem" href="tutorial-iss.html">Indirect simple shooting</a></li><li><a class="tocitem" href="tutorial-goddard.html">Goddard: direct, indirect</a></li><li><a class="tocitem" href="tutorial-lqr-basic.html">Linear–quadratic regulator</a></li><li><a class="tocitem" href="tutorial-mam.html">Minimal action</a></li></ul></li><li><span class="tocitem">Developers</span><ul><li><a class="tocitem" href="dev-optimalcontrol.html">OptimalControl.jl</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Subpackages</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="dev-ctbase.html">CTBase.jl</a></li><li><a class="tocitem" href="dev-ctdirect.html">CTDirect.jl</a></li><li><a class="tocitem" href="dev-ctflows.html">CTFlows.jl</a></li><li><a class="tocitem" href="dev-ctmodels.html">CTModels.jl</a></li><li><a class="tocitem" href="dev-ctparser.html">CTParser.jl</a></li></ul></li></ul></li><li><a class="tocitem" href="zhejiang-2025.html">Zhejiang 2025</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials and Advanced Features</a></li><li class="is-active"><a href="tutorial-continuation.html">Discrete continuation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="tutorial-continuation.html">Discrete continuation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/control-toolbox/OptimalControl.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/control-toolbox/OptimalControl.jl/blob/main/docs/src/tutorial-continuation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Discrete-continuation"><a class="docs-heading-anchor" href="#Discrete-continuation">Discrete continuation</a><a id="Discrete-continuation-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-continuation" title="Permalink"></a></h1><p>Using the warm start option, it is easy to implement a basic discrete continuation method, where a sequence of problems is solved using each solution as initial guess for the next problem. This usually gives better and faster convergence than solving each problem with the same initial guess, and is a way to handle problems that require a good initial guess.</p><h2 id="Continuation-on-parametric-OCP"><a class="docs-heading-anchor" href="#Continuation-on-parametric-OCP">Continuation on parametric OCP</a><a id="Continuation-on-parametric-OCP-1"></a><a class="docs-heading-anchor-permalink" href="#Continuation-on-parametric-OCP" title="Permalink"></a></h2><p>The most compact syntax to perform a discrete continuation is to use a function that returns the OCP for a given value of the continuation parameter, and solve a sequence of these problems. We illustrate this on a very basic double integrator with increasing fixed final time.</p><p>First we load the required packages</p><pre><code class="language-julia hljs">using OptimalControl
using NLPModelsIpopt
using Printf
using Plots</code></pre><p>and write a function that returns the OCP for a given final time</p><pre><code class="language-julia hljs">function ocp_T(T)
    ocp = @def begin
        t ∈ [0, T], time
        x ∈ R², state
        u ∈ R, control
        q = x₁
        v = x₂
        q(0) == 0
        v(0) == 0
        q(T) == 1
        v(T) == 0
        ẋ(t) == [ v(t), u(t) ]
        ∫(u(t)^2) → min
    end
    return ocp
end</code></pre><p>Then we perform the continuation with a simple <em>for</em> loop, using each solution to initialize the next problem.</p><pre><code class="language-julia hljs">init1 = ()
for T=1:5
    ocp1 = ocp_T(T)
    sol1 = solve(ocp1; display=false, init=init1)
    global init1 = sol1
    @printf(&quot;T %.2f objective %9.6f iterations %d\n&quot;, T, objective(sol1), iterations(sol1))
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">T 1.00 objective 12.000766 iterations 2
T 2.00 objective  1.500096 iterations 3
T 3.00 objective  0.444473 iterations 3
T 4.00 objective  0.187512 iterations 3
T 5.00 objective  0.095994 iterations 2</code></pre><h2 id="Continuation-on-global-variable"><a class="docs-heading-anchor" href="#Continuation-on-global-variable">Continuation on global variable</a><a id="Continuation-on-global-variable-1"></a><a class="docs-heading-anchor-permalink" href="#Continuation-on-global-variable" title="Permalink"></a></h2><p>As a second example, we show how to avoid redefining a new OCP each time, and modify the original one instead. More precisely we now solve a Goddard problem for a decreasing maximal thrust. If we store the value for <em>Tmax</em> in a global variable, we can simply modify this variable and keep the same OCP problem during the continuation.</p><p>Let us first define the Goddard problem (note that the formulation below illustrates all the possible constraints types, and the problem could be defined in a more compact way).</p><pre><code class="language-julia hljs">Cd = 310
Tmax = 3.5
β = 500
b = 2
function F0(x)
    r, v, m = x
    D = Cd * v^2 * exp(-β*(r - 1))
    return [ v, -D/m - 1/r^2, 0 ]
end
function F1(x)
    r, v, m = x
    return [ 0, Tmax/m, -b*Tmax ]
end
r0 = 1
v0 = 0
m0 = 1
mf = 0.6
x0 = [r0, v0, m0]
vmax = 0.1

@def ocp begin
    tf ∈ R, variable
    t ∈ [0, tf], time
    x ∈ R^3, state
    u ∈ R, control
    0.01 ≤ tf ≤ Inf
    r = x[1]
    v = x[2]
    m = x[3]
    x(0) == x0
    m(tf) == mf
    r0 ≤ r(t) ≤ r0 + 0.1
    v0 ≤ v(t) ≤ vmax
    mf ≤ m(t) ≤ m0
    0 ≤ u(t) ≤ 1
    ẋ(t) == F0(x(t)) + u(t) * F1(x(t))
    r(tf) → max
end

sol0 = solve(ocp; display=false)
@printf(&quot;Objective for reference solution %.6f\n&quot;, objective(sol0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Objective for reference solution 1.012575</code></pre><p>Then we perform the continuation on the maximal thrust.</p><pre><code class="language-julia hljs">sol       = sol0
Tmax_list = []
obj_list  = []
for Tmax_local=3.5:-0.5:1
    global Tmax = Tmax_local
    global sol = solve(ocp; display=false, init=sol)
    @printf(&quot;Tmax %.2f objective %.6f iterations %d\n&quot;, Tmax, objective(sol), iterations(sol))
    push!(Tmax_list, Tmax)
    push!(obj_list, objective(sol))
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Tmax 3.50 objective 1.012575 iterations 10
Tmax 3.00 objective 1.012371 iterations 13
Tmax 2.50 objective 1.012023 iterations 15
Tmax 2.00 objective 1.011252 iterations 14
Tmax 1.50 objective 1.009172 iterations 20
Tmax 1.00 objective 1.003593 iterations 19</code></pre><p>We plot now the objective w.r.t the maximal thrust, as well as both solutions for <em>Tmax</em>=3.5 and <em>Tmax</em>=1.</p><pre><code class="language-julia hljs">using Plots.PlotMeasures # for leftmargin

plt_obj = plot(Tmax_list, obj_list;
    seriestype=:scatter,
    title=&quot;Goddard problem&quot;,
    label=&quot;r(tf)&quot;,
    xlabel=&quot;Maximal thrust (Tmax)&quot;,
    ylabel=&quot;Maximal altitude r(tf)&quot;)

plt_sol = plot(sol0; solution_label=&quot;(Tmax = &quot;*string(Tmax_list[1])*&quot;)&quot;)
plot!(plt_sol, sol;  solution_label=&quot;(Tmax = &quot;*string(Tmax_list[end])*&quot;)&quot;)

layout = grid(2, 1, heights=[0.2, 0.8])
plot(plt_obj, plt_sol; layout=layout, size=(800, 1000), leftmargin=5mm)</code></pre><img src="tutorial-continuation-d2a857ec.svg" alt="Example block output"/><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="tutorial-flow.html">« Compute flows</a><a class="docs-footer-nextpage" href="tutorial-discretisation.html">Discretisation methods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Wednesday 23 April 2025 09:10">Wednesday 23 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
