<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>JLESC17 · OptimalControl.jl</title><meta name="title" content="JLESC17 · OptimalControl.jl"/><meta property="og:title" content="JLESC17 · OptimalControl.jl"/><meta property="twitter:title" content="JLESC17 · OptimalControl.jl"/><meta name="description" content="Documentation for OptimalControl.jl."/><meta property="og:description" content="Documentation for OptimalControl.jl."/><meta property="twitter:description" content="Documentation for OptimalControl.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="https://control-toolbox.org/assets/css/documentation.css" rel="stylesheet" type="text/css"/><script src="https://control-toolbox.org/assets/js/documentation.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">OptimalControl.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Getting Started</a></li><li><span class="tocitem">Basic Examples</span><ul><li><a class="tocitem" href="example-double-integrator-energy.html">Energy minimisation</a></li><li><a class="tocitem" href="example-double-integrator-time.html">Time mininimisation</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="manual-abstract.html">Define a problem</a></li><li><a class="tocitem" href="manual-ai-ded.html">Use AI</a></li><li><a class="tocitem" href="manual-model.html">Problem characteristics</a></li><li><a class="tocitem" href="manual-initial-guess.html">Set an initial guess</a></li><li><a class="tocitem" href="manual-solve.html">Solve a problem</a></li><li><a class="tocitem" href="manual-solve-gpu.html">Solve on GPU</a></li><li><a class="tocitem" href="manual-solution.html">Solution characteristics</a></li><li><a class="tocitem" href="manual-plot.html">Plot a solution</a></li><li><input class="collapse-toggle" id="menuitem-3-9" type="checkbox"/><label class="tocitem" for="menuitem-3-9"><span class="docs-label">Compute flows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="manual-flow-api.html">Flow API</a></li><li><a class="tocitem" href="manual-flow-ocp.html">From optimal control problems</a></li><li><a class="tocitem" href="manual-flow-others.html">From Hamiltonians and others</a></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="api-optimalcontrol-user.html">OptimalControl.jl - User</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Subpackages - Developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="api-ctbase.html">CTBase.jl</a></li><li><a class="tocitem" href="api-ctdirect.html">CTDirect.jl</a></li><li><a class="tocitem" href="api-ctflows.html">CTFlows.jl</a></li><li><a class="tocitem" href="api-ctmodels.html">CTModels.jl</a></li><li><a class="tocitem" href="api-ctparser.html">CTParser.jl</a></li><li><a class="tocitem" href="api-optimalcontrol-dev.html">OptimalControl.jl</a></li></ul></li></ul></li><li><a class="tocitem" href="zhejiang-2025.html">Zhejiang 2025</a></li><li class="is-active"><a class="tocitem" href="jlesc17.html">JLESC17</a><ul class="internal"><li><a class="tocitem" href="#What-it&#39;s-about"><span>What it&#39;s about</span></a></li><li><a class="tocitem" href="#Discretise-then-solve-strategy-(*aka*-direct-methods)"><span>Discretise then solve strategy (<em>aka</em> direct methods)</span></a></li><li><a class="tocitem" href="#Wrap-up"><span>Wrap up</span></a></li><li><a class="tocitem" href="#Future"><span>Future</span></a></li><li><a class="tocitem" href="#control-toolbox.org"><span>control-toolbox.org</span></a></li><li><a class="tocitem" href="#Credits-(not-exhaustive!)"><span>Credits (not exhaustive!)</span></a></li><li><a class="tocitem" href="#Acknowledgements"><span>Acknowledgements</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="jlesc17.html">JLESC17</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="jlesc17.html">JLESC17</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/control-toolbox/OptimalControl.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/control-toolbox/OptimalControl.jl/blob/main/docs/src/jlesc17.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><img width="800" alt="jlesc17" src="./assets/jlesc17.jpg"><h1 id="Solving-optimal-control-problems-on-GPU-with-Julia"><a class="docs-heading-anchor" href="#Solving-optimal-control-problems-on-GPU-with-Julia">Solving optimal control problems on GPU with Julia</a><a id="Solving-optimal-control-problems-on-GPU-with-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-optimal-control-problems-on-GPU-with-Julia" title="Permalink"></a></h1><h3 id="[Jean-Baptiste-Caillau](http://caillau.perso.math.cnrs.fr),-[Olivier-Cots](https://ocots.github.io),-[Joseph-Gergaud](https://github.com/joseph-gergaud),-[Pierre-Martinon](https://github.com/PierreMartinon),-[Sophia-Sed](https://sed-sam-blog.gitlabpages.inria.fr)"><a class="docs-heading-anchor" href="#[Jean-Baptiste-Caillau](http://caillau.perso.math.cnrs.fr),-[Olivier-Cots](https://ocots.github.io),-[Joseph-Gergaud](https://github.com/joseph-gergaud),-[Pierre-Martinon](https://github.com/PierreMartinon),-[Sophia-Sed](https://sed-sam-blog.gitlabpages.inria.fr)"><a href="http://caillau.perso.math.cnrs.fr">Jean-Baptiste Caillau</a>, <a href="https://ocots.github.io">Olivier Cots</a>, <a href="https://github.com/joseph-gergaud">Joseph Gergaud</a>, <a href="https://github.com/PierreMartinon">Pierre Martinon</a>, <a href="https://sed-sam-blog.gitlabpages.inria.fr">Sophia Sed</a></a><a id="[Jean-Baptiste-Caillau](http://caillau.perso.math.cnrs.fr),-[Olivier-Cots](https://ocots.github.io),-[Joseph-Gergaud](https://github.com/joseph-gergaud),-[Pierre-Martinon](https://github.com/PierreMartinon),-[Sophia-Sed](https://sed-sam-blog.gitlabpages.inria.fr)-1"></a><a class="docs-heading-anchor-permalink" href="#[Jean-Baptiste-Caillau](http://caillau.perso.math.cnrs.fr),-[Olivier-Cots](https://ocots.github.io),-[Joseph-Gergaud](https://github.com/joseph-gergaud),-[Pierre-Martinon](https://github.com/PierreMartinon),-[Sophia-Sed](https://sed-sam-blog.gitlabpages.inria.fr)" title="Permalink"></a></h3><img width="800" alt="affiliations" src="./assets/affil.jpg"><h2 id="What-it&#39;s-about"><a class="docs-heading-anchor" href="#What-it&#39;s-about">What it&#39;s about</a><a id="What-it&#39;s-about-1"></a><a class="docs-heading-anchor-permalink" href="#What-it&#39;s-about" title="Permalink"></a></h2><ul><li>Nonlinear optimal control of ODEs:</li></ul><p class="math-container">\[g(x(t_0),x(t_f)) + \int_{t_0}^{t_f} f^0(x(t), u(t))\, \mathrm{d}t \to \min\]</p><p>subject to</p><p class="math-container">\[\dot{x}(t) = f(x(t), u(t)),\quad t \in [t_0, t_f]\]</p><p>plus boundary, control and state constraints</p><ul><li>Our core interests: numerical &amp; geometrical methods in control, applications</li><li>Why Julia: fast (+ JIT), strongly typed, high-level (AD, macros), fast optimisation and ODE solvers available, rapidly growing community</li></ul><img width="800" alt="juliacon2025" src="./assets/juliacon2025.jpg"><h2 id="Discretise-then-solve-strategy-(*aka*-direct-methods)"><a class="docs-heading-anchor" href="#Discretise-then-solve-strategy-(*aka*-direct-methods)">Discretise then solve strategy (<em>aka</em> direct methods)</a><a id="Discretise-then-solve-strategy-(*aka*-direct-methods)-1"></a><a class="docs-heading-anchor-permalink" href="#Discretise-then-solve-strategy-(*aka*-direct-methods)" title="Permalink"></a></h2><ul><li>Discretising an OCP into an NLP: <span>$h_i := t_{i+1}-t_i$</span>,</li></ul><p class="math-container">\[g(X_0,X_N) + \sum_{i=0}^{N} h_i f^0(X_i,U_i) \to \min\]</p><p>subject to </p><p class="math-container">\[X_{i+1} - X_i - h_i f(X_i, U_i) = 0,\quad i = 0,\dots,N-1\]</p><p>plus other constraints on <span>$X := (X_i)_{i=0,N}$</span> and <span>$U := (U_i)_{i=0,N}$</span> such as boundary and path (state and / or control) constraints :</p><p class="math-container">\[b(t_0, X_0, t_N, X_N) = 0\]</p><p class="math-container">\[c(X_i, U_i) = 0,\quad i = 0,\dots,N\]</p><ul><li>SIMD parallelism (<span>$f_0$</span>, <span>$f$</span>, <span>$g$</span>) + sparsity: Kernels for GPU (<a href="https://juliagpu.github.io/KernelAbstractions.jl/stable/">KernelAbstraction.jl</a>) and sparse linear algebra (<a href="https://github.com/exanauts/CUDSS.jl">CUDSS.jl</a>)</li><li>Modelling and optimising for GPU: <a href="https://exanauts.github.io/ExaModels.jl/dev/guide">ExaModels.jl</a>  + <a href="https://madnlp.github.io/MadNLP.jl">MadNLP.jl</a>, with <strong>built-in AD</strong></li><li><a href="example-double-integrator-energy.html#example-double-integrator-energy">Simple example, DSL</a></li><li>Compile into an ExaModel (one pass compiler, <a href="https://github.com/control-toolbox/CTParser.jl/blob/20c6be5c953587fef10b054a95f9dc8c66b90577/src/onepass.jl#L145">syntax + semantics</a>)</li></ul><details><summary>Simple example, generated code</summary><pre><code class="language-julia hljs">begin
    #= /data/caillau/CTParser.jl/src/onepass.jl:1003 =#
    function (; scheme = :trapezoidal, grid_size = 200, backend = nothing, init = (0.1, 0.1, 0.1), base_type = Float64)
        #= /data/caillau/CTParser.jl/src/onepass.jl:1003 =#
        #= /data/caillau/CTParser.jl/src/onepass.jl:1004 =#
        LineNumberNode(0, &quot;box constraints: variable&quot;)
        #= /data/caillau/CTParser.jl/src/onepass.jl:1005 =#
        begin
            LineNumberNode(0, &quot;box constraints: state&quot;)
            begin
                var&quot;##235&quot; = -Inf * ones(3)
                #= /data/caillau/CTParser.jl/src/onepass.jl:461 =#
                var&quot;##236&quot; = Inf * ones(3)
            end
        end
        #= /data/caillau/CTParser.jl/src/onepass.jl:1006 =#
        begin
            LineNumberNode(0, &quot;box constraints: control&quot;)
            begin
                var&quot;##237&quot; = -Inf * ones(1)
                #= /data/caillau/CTParser.jl/src/onepass.jl:512 =#
                var&quot;##238&quot; = Inf * ones(1)
            end
        end
        #= /data/caillau/CTParser.jl/src/onepass.jl:1007 =#
        var&quot;##230&quot; = ExaModels.ExaCore(base_type; backend = backend)
        #= /data/caillau/CTParser.jl/src/onepass.jl:1008 =#
        begin
            #= /data/caillau/CTParser.jl/test/test_onepass_exa.jl:23 =#
            var&quot;##232&quot; = begin
                    #= /data/caillau/CTParser.jl/src/onepass.jl:111 =#
                    local ex
                    #= /data/caillau/CTParser.jl/src/onepass.jl:112 =#
                    try
                        #= /data/caillau/CTParser.jl/src/onepass.jl:113 =#
                        (1 - 0) / grid_size
                    catch ex
                        #= /data/caillau/CTParser.jl/src/onepass.jl:115 =#
                        println(&quot;Line &quot;, 1, &quot;: &quot;, &quot;(t ∈ [0, 1], time)&quot;)
                        #= /data/caillau/CTParser.jl/src/onepass.jl:116 =#
                        throw(ex)
                    end
                end
            #= /data/caillau/CTParser.jl/test/test_onepass_exa.jl:24 =#
            x = begin
                    #= /data/caillau/CTParser.jl/src/onepass.jl:111 =#
                    local ex
                    #= /data/caillau/CTParser.jl/src/onepass.jl:112 =#
                    try
                        #= /data/caillau/CTParser.jl/src/onepass.jl:113 =#
                        ExaModels.variable(var&quot;##230&quot;, 3, 0:grid_size; lvar = [var&quot;##235&quot;[i] for (i, j) = Base.product(1:3, 0:grid_size)], uvar = [var&quot;##236&quot;[i] for (i, j) = Base.product(1:3, 0:grid_size)], start = init[2])
                    catch ex
                        #= /data/caillau/CTParser.jl/src/onepass.jl:115 =#
                        println(&quot;Line &quot;, 2, &quot;: &quot;, &quot;(x ∈ R ^ 3, state)&quot;)
                        #= /data/caillau/CTParser.jl/src/onepass.jl:116 =#
                        throw(ex)
                    end
                end
            #= /data/caillau/CTParser.jl/test/test_onepass_exa.jl:25 =#
            var&quot;u##239&quot; = begin
                    #= /data/caillau/CTParser.jl/src/onepass.jl:111 =#
                    local ex
                    #= /data/caillau/CTParser.jl/src/onepass.jl:112 =#
                    try
                        #= /data/caillau/CTParser.jl/src/onepass.jl:113 =#
                        ExaModels.variable(var&quot;##230&quot;, 1, 0:grid_size; lvar = [var&quot;##237&quot;[i] for (i, j) = Base.product(1:1, 0:grid_size)], uvar = [var&quot;##238&quot;[i] for (i, j) = Base.product(1:1, 0:grid_size)], start = init[3])
                    catch ex
                        #= /data/caillau/CTParser.jl/src/onepass.jl:115 =#
                        println(&quot;Line &quot;, 3, &quot;: &quot;, &quot;(u ∈ R, control)&quot;)
                        #= /data/caillau/CTParser.jl/src/onepass.jl:116 =#
                        throw(ex)
                    end
                end
            #= /data/caillau/CTParser.jl/test/test_onepass_exa.jl:26 =#
            begin
                #= /data/caillau/CTParser.jl/src/onepass.jl:111 =#
                local ex
                #= /data/caillau/CTParser.jl/src/onepass.jl:112 =#
                try
                    #= /data/caillau/CTParser.jl/src/onepass.jl:113 =#
                    ExaModels.constraint(var&quot;##230&quot;, (x[i, 0] for i = 1:3); lcon = [-1, 0, 0], ucon = [-1, 0, 0])
                catch ex
                    #= /data/caillau/CTParser.jl/src/onepass.jl:115 =#
                    println(&quot;Line &quot;, 4, &quot;: &quot;, &quot;x(0) == [-1, 0, 0]&quot;)
                    #= /data/caillau/CTParser.jl/src/onepass.jl:116 =#
                    throw(ex)
                end
            end
            #= /data/caillau/CTParser.jl/test/test_onepass_exa.jl:27 =#
            begin
                #= /data/caillau/CTParser.jl/src/onepass.jl:111 =#
                local ex
                #= /data/caillau/CTParser.jl/src/onepass.jl:112 =#
                try
                    #= /data/caillau/CTParser.jl/src/onepass.jl:113 =#
                    ExaModels.constraint(var&quot;##230&quot;, (x[i, grid_size] for i = 1:2); lcon = [0, 0], ucon = [0, 0])
                catch ex
                    #= /data/caillau/CTParser.jl/src/onepass.jl:115 =#
                    println(&quot;Line &quot;, 5, &quot;: &quot;, &quot;(x[1:2])(1) == [0, 0]&quot;)
                    #= /data/caillau/CTParser.jl/src/onepass.jl:116 =#
                    throw(ex)
                end
            end
            #= /data/caillau/CTParser.jl/test/test_onepass_exa.jl:28 =#
            begin
                #= /data/caillau/CTParser.jl/src/onepass.jl:111 =#
                local ex
                #= /data/caillau/CTParser.jl/src/onepass.jl:112 =#
                try
                    #= /data/caillau/CTParser.jl/src/onepass.jl:113 =#
                    begin
                        #= /data/caillau/CTParser.jl/src/onepass.jl:735 =#
                        if scheme == :trapezoidal
                            #= /data/caillau/CTParser.jl/src/onepass.jl:736 =#
                            ExaModels.constraint(var&quot;##230&quot;, ((x[1, j + 1] - x[1, j]) - (var&quot;##232&quot; * (x[2, j] + x[2, j + 1])) / 2 for j = 0:grid_size - 1))
                        elseif #= /data/caillau/CTParser.jl/src/onepass.jl:737 =# scheme == :euler
                            #= /data/caillau/CTParser.jl/src/onepass.jl:738 =#
                            ExaModels.constraint(var&quot;##230&quot;, ((x[1, j + 1] - x[1, j]) - var&quot;##232&quot; * x[2, j] for j = 0:grid_size - 1))
                        elseif #= /data/caillau/CTParser.jl/src/onepass.jl:739 =# scheme == :euler_b
                            #= /data/caillau/CTParser.jl/src/onepass.jl:740 =#
                            ExaModels.constraint(var&quot;##230&quot;, ((x[1, j + 1] - x[1, j]) - var&quot;##232&quot; * x[2, j + 1] for j = 0:grid_size - 1))
                        else
                            #= /data/caillau/CTParser.jl/src/onepass.jl:742 =#
                            throw(&quot;unknown numerical scheme&quot;)
                        end
                    end
                catch ex
                    #= /data/caillau/CTParser.jl/src/onepass.jl:115 =#
                    println(&quot;Line &quot;, 6, &quot;: &quot;, &quot;(∂(x₁))(t) == x₂(t)&quot;)
                    #= /data/caillau/CTParser.jl/src/onepass.jl:116 =#
                    throw(ex)
                end
            end
            #= /data/caillau/CTParser.jl/test/test_onepass_exa.jl:29 =#
            begin
                #= /data/caillau/CTParser.jl/src/onepass.jl:111 =#
                local ex
                #= /data/caillau/CTParser.jl/src/onepass.jl:112 =#
                try
                    #= /data/caillau/CTParser.jl/src/onepass.jl:113 =#
                    begin
                        #= /data/caillau/CTParser.jl/src/onepass.jl:735 =#
                        if scheme == :trapezoidal
                            #= /data/caillau/CTParser.jl/src/onepass.jl:736 =#
                            ExaModels.constraint(var&quot;##230&quot;, ((x[2, j + 1] - x[2, j]) - (var&quot;##232&quot; * (var&quot;u##239&quot;[1, j] + var&quot;u##239&quot;[1, j + 1])) / 2 for j = 0:grid_size - 1))
                        elseif #= /data/caillau/CTParser.jl/src/onepass.jl:737 =# scheme == :euler
                            #= /data/caillau/CTParser.jl/src/onepass.jl:738 =#
                            ExaModels.constraint(var&quot;##230&quot;, ((x[2, j + 1] - x[2, j]) - var&quot;##232&quot; * var&quot;u##239&quot;[1, j] for j = 0:grid_size - 1))
                        elseif #= /data/caillau/CTParser.jl/src/onepass.jl:739 =# scheme == :euler_b
                            #= /data/caillau/CTParser.jl/src/onepass.jl:740 =#
                            ExaModels.constraint(var&quot;##230&quot;, ((x[2, j + 1] - x[2, j]) - var&quot;##232&quot; * var&quot;u##239&quot;[1, j + 1] for j = 0:grid_size - 1))
                        else
                            #= /data/caillau/CTParser.jl/src/onepass.jl:742 =#
                            throw(&quot;unknown numerical scheme&quot;)
                        end
                    end
                catch ex
                    #= /data/caillau/CTParser.jl/src/onepass.jl:115 =#
                    println(&quot;Line &quot;, 7, &quot;: &quot;, &quot;(∂(x₂))(t) == u(t)&quot;)
                    #= /data/caillau/CTParser.jl/src/onepass.jl:116 =#
                    throw(ex)
                end
            end
            #= /data/caillau/CTParser.jl/test/test_onepass_exa.jl:30 =#
            begin
                #= /data/caillau/CTParser.jl/src/onepass.jl:111 =#
                local ex
                #= /data/caillau/CTParser.jl/src/onepass.jl:112 =#
                try
                    #= /data/caillau/CTParser.jl/src/onepass.jl:113 =#
                    begin
                        #= /data/caillau/CTParser.jl/src/onepass.jl:735 =#
                        if scheme == :trapezoidal
                            #= /data/caillau/CTParser.jl/src/onepass.jl:736 =#
                            ExaModels.constraint(var&quot;##230&quot;, ((x[3, j + 1] - x[3, j]) - (var&quot;##232&quot; * (0.5 * var&quot;u##239&quot;[1, j] ^ 2 + 0.5 * var&quot;u##239&quot;[1, j + 1] ^ 2)) / 2 for j = 0:grid_size - 1))
                        elseif #= /data/caillau/CTParser.jl/src/onepass.jl:737 =# scheme == :euler
                            #= /data/caillau/CTParser.jl/src/onepass.jl:738 =#
                            ExaModels.constraint(var&quot;##230&quot;, ((x[3, j + 1] - x[3, j]) - var&quot;##232&quot; * (0.5 * var&quot;u##239&quot;[1, j] ^ 2) for j = 0:grid_size - 1))
                        elseif #= /data/caillau/CTParser.jl/src/onepass.jl:739 =# scheme == :euler_b
                            #= /data/caillau/CTParser.jl/src/onepass.jl:740 =#
                            ExaModels.constraint(var&quot;##230&quot;, ((x[3, j + 1] - x[3, j]) - var&quot;##232&quot; * (0.5 * var&quot;u##239&quot;[1, j + 1] ^ 2) for j = 0:grid_size - 1))
                        else
                            #= /data/caillau/CTParser.jl/src/onepass.jl:742 =#
                            throw(&quot;unknown numerical scheme&quot;)
                        end
                    end
                catch ex
                    #= /data/caillau/CTParser.jl/src/onepass.jl:115 =#
                    println(&quot;Line &quot;, 8, &quot;: &quot;, &quot;(∂(x₃))(t) == 0.5 * u(t) ^ 2&quot;)
                    #= /data/caillau/CTParser.jl/src/onepass.jl:116 =#
                    throw(ex)
                end
            end
            #= /data/caillau/CTParser.jl/test/test_onepass_exa.jl:31 =#
            begin
                #= /data/caillau/CTParser.jl/src/onepass.jl:111 =#
                local ex
                #= /data/caillau/CTParser.jl/src/onepass.jl:112 =#
                try
                    #= /data/caillau/CTParser.jl/src/onepass.jl:113 =#
                    ExaModels.objective(var&quot;##230&quot;, x[3, grid_size])
                catch ex
                    #= /data/caillau/CTParser.jl/src/onepass.jl:115 =#
                    println(&quot;Line &quot;, 9, &quot;: &quot;, &quot;x₃(1) → min&quot;)
                    #= /data/caillau/CTParser.jl/src/onepass.jl:116 =#
                    throw(ex)
                end
            end
        end
        #= /data/caillau/CTParser.jl/src/onepass.jl:1009 =#
        begin
            #= /data/caillau/CTParser.jl/src/onepass.jl:994 =#
            !(isempty([1, 2, 3])) || throw(CTBase.ParsingError(&quot;dynamics not defined&quot;))
            #= /data/caillau/CTParser.jl/src/onepass.jl:995 =#
            sort([1, 2, 3]) == 1:3 || throw(CTBase.ParsingError(&quot;some coordinates of dynamics undefined&quot;))
        end
        #= /data/caillau/CTParser.jl/src/onepass.jl:1010 =#
        return ExaModels.ExaModel(var&quot;##230&quot;)
    end
end</code></pre></details><ul><li>Solving (MadNLP + CUDSS)</li></ul><pre><code class="language-julia hljs">This is MadNLP version v0.8.7, running with cuDSS v0.4.0

Number of nonzeros in constraint Jacobian............:    12005
Number of nonzeros in Lagrangian Hessian.............:     9000

Total number of variables............................:     4004
                     variables with only lower bounds:        0
                variables with lower and upper bounds:        0
                     variables with only upper bounds:        0
Total number of equality constraints.................:     3005
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  1.0000000e-01 1.10e+00 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1  1.0001760e-01 1.10e+00 3.84e-03  -1.0 6.88e+02  -4.0 1.00e+00 2.00e-07h  2
   2 -5.2365072e-03 1.89e-02 1.79e-07  -1.0 6.16e+00  -4.5 1.00e+00 1.00e+00h  1
   3  5.9939621e+00 2.28e-03 1.66e-04  -3.8 6.00e+00  -5.0 9.99e-01 1.00e+00h  1
   4  5.9996210e+00 2.94e-06 8.38e-07  -3.8 7.70e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 4

                                   (scaled)                 (unscaled)
Objective...............:   5.9996210189633494e+00    5.9996210189633494e+00
Dual infeasibility......:   8.3756005011360529e-07    8.3756005011360529e-07
Constraint violation....:   2.9426923277963834e-06    2.9426923277963834e-06
Complementarity.........:   2.0007459547789288e-06    2.0007459547789288e-06
Overall NLP error.......:   2.9426923277963834e-06    2.9426923277963834e-06

Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 5
Number of constraint evaluations                     = 6
Number of constraint Jacobian evaluations            = 5
Number of Lagrangian Hessian evaluations             = 4
Total wall-clock secs in solver (w/o fun. eval./lin. alg.)  =  0.072
Total wall-clock secs in linear solver                      =  0.008
Total wall-clock secs in NLP function evaluations           =  0.003
Total wall-clock secs                                       =  0.083</code></pre><ul><li><a href="https://control-toolbox.org/Tutorials.jl/stable/tutorial-goddard.html">Goddard problem</a></li></ul><pre><code class="language-julia hljs">This is MadNLP version v0.8.4, running with cuDSS v0.3.0

Number of nonzeros in constraint Jacobian............:   135017
Number of nonzeros in Lagrangian Hessian.............:   130008

Total number of variables............................:    35008
                     variables with only lower bounds:        0
                variables with lower and upper bounds:        0
                     variables with only upper bounds:        0
Total number of equality constraints.................:    30007
Total number of inequality constraints...............:    15004
        inequality constraints with only lower bounds:     5002
   inequality constraints with lower and upper bounds:    10002
        inequality constraints with only upper bounds:        0

[...]

Number of Iterations....: 35

                                   (scaled)                 (unscaled)
Objective...............:  -1.0142336978192805e+00   -1.0142336978192805e+00
Dual infeasibility......:   4.7384318691001681e-13    4.7384318691001681e-13
Constraint violation....:   1.4068322357215250e-09    1.4068322357215250e-09
Complementarity.........:   9.0909295306344959e-09    9.0909295306344959e-09
Overall NLP error.......:   9.0909295306344959e-09    9.0909295306344959e-09

Number of objective function evaluations             = 36
Number of objective gradient evaluations             = 36
Number of constraint evaluations                     = 36
Number of constraint Jacobian evaluations            = 36
Number of Lagrangian Hessian evaluations             = 35
Total wall-clock secs in solver (w/o fun. eval./lin. alg.)  =  0.911
Total wall-clock secs in linear solver                      =  0.227
Total wall-clock secs in NLP function evaluations           =  0.059
Total wall-clock secs                                       =  1.198</code></pre><h2 id="Wrap-up"><a class="docs-heading-anchor" href="#Wrap-up">Wrap up</a><a id="Wrap-up-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-up" title="Permalink"></a></h2><ul><li>High level modelling of optimal control problems</li><li>Solving on CPU and GPU</li></ul><h2 id="Future"><a class="docs-heading-anchor" href="#Future">Future</a><a id="Future-1"></a><a class="docs-heading-anchor-permalink" href="#Future" title="Permalink"></a></h2><ul><li>New applications (space mechanics, biology, quantum mechanics and more)</li><li>Additional solvers: benchmarking on CPU / GPU for optimisation, Hamiltonian shooting and pathfollowing</li><li>Improved AD: collab between Argonne and Inria, <a href="https://jlesc.github.io/projects/shared_infra_ad">JLESC Shared Infra AD</a> project...</li><li>... and open to contributions! If you like the package, please give us a star ⭐️</li></ul><a href="https://github.com/control-toolbox/OptimalControl.jl"><img width="800" alt="OptimalControl.jl" src="./assets/star.jpg"></a><h2 id="control-toolbox.org"><a class="docs-heading-anchor" href="#control-toolbox.org">control-toolbox.org</a><a id="control-toolbox.org-1"></a><a class="docs-heading-anchor-permalink" href="#control-toolbox.org" title="Permalink"></a></h2><ul><li>Open toolbox</li><li>Collection of Julia Packages rooted at <a href="https://control-toolbox.org/OptimalControl.jl">OptimalControl.jl</a></li></ul><a href="https://control-toolbox.org"><img width="800" alt="control-toolbox.org" src="./assets/control-toolbox.jpg"></a><h2 id="Credits-(not-exhaustive!)"><a class="docs-heading-anchor" href="#Credits-(not-exhaustive!)">Credits (not exhaustive!)</a><a id="Credits-(not-exhaustive!)-1"></a><a class="docs-heading-anchor-permalink" href="#Credits-(not-exhaustive!)" title="Permalink"></a></h2><ul><li><a href="https://jso.dev/ADNLPModels.jl">ADNLPModels.jl</a></li><li><a href="https://juliadiff.org/DifferentiationInterface.jl/DifferentiationInterface">DifferentiationInterface.jl</a></li><li><a href="https://docs.sciml.ai/DiffEqDocs">DifferentialEquations.jl</a></li><li><a href="https://exanauts.github.io/ExaModels.jl/dev/guide">ExaModels.jl</a></li><li><a href="https://github.com/jump-dev/Ipopt.jl">Ipopt.jl</a></li><li><a href="https://madnlp.github.io/MadNLP.jl">MadNLP.jl</a></li><li><a href="https://thautwarm.github.io/MLStyle.jl">MLStyle.jl</a></li></ul><h2 id="Acknowledgements"><a class="docs-heading-anchor" href="#Acknowledgements">Acknowledgements</a><a id="Acknowledgements-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgements" title="Permalink"></a></h2><p>Jean-Baptiste Caillau is partially funded by a <strong>France 2030</strong> support managed by the <em>Agence Nationale de la Recherche</em>, under the reference ANR-23-PEIA-0004 (<a href="https://pde-ai.math.cnrs.fr">PDE-AI</a> project).</p><img width="150" alt="affiliations" src="./assets/france-2030.png"><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="zhejiang-2025.html">« Zhejiang 2025</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 7 August 2025 17:01">Thursday 7 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
